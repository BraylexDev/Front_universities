<div class="card border-0 shadow-sm">
  <div class="card-header bg-primary text-white">
    <h4 class="mb-0">
      <i class="pi pi-person-gear me-2"></i>Información Personal
    </h4>
  </div>
  <div class="card-body p-4">
    <form [formGroup]="profileForm" (ngSubmit)="onSaveProfile()">
      <div class="row">
        <div class="col-md-6 mb-3">
          <label for="name" class="form-label fw-semibold">
            <i class="pi pi-person-badge me-2"></i>Nombre Completo
          </label>
          <input
            type="text"
            class="form-control form-control-lg"
            [class.is-invalid]="isFieldInvalid('name')"
            id="name"
            formControlName="name"
            placeholder="Tu nombre completo"
          />
          <div class="invalid-feedback" *ngIf="isFieldInvalid('name')">
            Nombre es requerido
          </div>
        </div>

        <div class="col-md-6 mb-3">
          <label for="userName" class="form-label fw-semibold">
            <i class="pi pi-at me-2"></i>Usuario
          </label>
          <input
            type="text"
            class="form-control form-control-lg"
            [class.is-invalid]="isFieldInvalid('userName')"
            id="userName"
            formControlName="userName"
            placeholder="Nombre de usuario"
          />
          <div class="invalid-feedback" *ngIf="isFieldInvalid('userName')">
            Usuario es requerido
          </div>
        </div>

        <div class="col-md-6 mb-3">
          <label for="email" class="form-label fw-semibold">
            <i class="pi pi-envelope me-2"></i>Email
          </label>
          <input
            type="email"
            class="form-control form-control-lg"
            [class.is-invalid]="isFieldInvalid('email')"
            id="email"
            formControlName="email"
            placeholder="tu@email.com"
          />
          <div class="invalid-feedback" *ngIf="isFieldInvalid('email')">
            Email válido es requerido
          </div>
        </div>

        <div class="col-md-6 mb-3">
          <label for="rol" class="form-label fw-semibold">
            <i class="pi pi-shield-check me-2"></i>Rol
          </label>
          <input
            type="text"
            class="form-control form-control-lg"
            id="rol"
            formControlName="rol"
            readonly
          />
        </div>
      </div>

      <hr class="my-4" />

      <h5 class="text-secondary mb-3">
        <i class="pi pi-key me-2"></i>Cambiar Contraseña (Opcional)
      </h5>

      <div class="row">
        <div class="col-md-6 mb-3">
          <label for="newPassword" class="form-label">Nueva Contraseña</label>
          <div class="input-group">
            <input
              [type]="showPassword ? 'text' : 'password'"
              class="form-control form-control-lg"
              id="newPassword"
              formControlName="newPassword"
              placeholder="Nueva contraseña"
            />
            <button
              class="btn btn-outline-secondary"
              type="button"
              (click)="togglePassword()"
            >
              <i [class]="showPassword ? 'pi pi-eye-slash' : 'pi pi-eye'"></i>
            </button>
          </div>
        </div>

        <div class="col-md-6 mb-3">
          <label for="confirmPassword" class="form-label"
            >Confirmar Contraseña</label
          >
          <input
            type="password"
            class="form-control form-control-lg"
            [class.is-invalid]="passwordMismatch"
            id="confirmPassword"
            formControlName="confirmPassword"
            placeholder="Confirmar nueva contraseña"
          />
          <div class="invalid-feedback" *ngIf="passwordMismatch">
            Las contraseñas no coinciden
          </div>
        </div>
      </div>

      <!-- Success Message -->
      <div class="alert alert-success" *ngIf="successMessage">
        <i class="pi pi-check-circle-fill me-2"></i>
        {{ successMessage }}
      </div>

      <!-- Error Message -->
      <div class="alert alert-danger" *ngIf="errorMessage">
        <i class="pi pi-exclamation-triangle-fill me-2"></i>
        {{ errorMessage }}
      </div>

      <div class="d-grid gap-2 d-md-flex justify-content-md-end">
        <button
          type="button"
          class="btn btn-outline-secondary btn-lg me-md-2"
          (click)="resetForm()"
        >
          <i class="pi pi-arrow-clockwise me-2"></i>Restablecer
        </button>
        <button
          type="submit"
          class="btn btn-primary btn-lg"
          [disabled]="isLoading || profileForm.invalid"
        >
          <span
            *ngIf="isLoading"
            class="spinner-border spinner-border-sm me-2"
          ></span>
          <i *ngIf="!isLoading" class="pi pi-save me-2"></i>
          {{ isLoading ? "Guardando..." : "Guardar Cambios" }}
        </button>
      </div>
    </form>
  </div>
</div>
